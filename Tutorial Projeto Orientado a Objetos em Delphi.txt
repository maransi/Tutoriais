SELECT DISTINCT 
    240 AS cdModelo, 
    a.cpfcnpj, 
    CASE 
        WHEN IFNULL(e.dddc,'') <> '' THEN 
            e.dddc 
        WHEN IFNULL(e.dddc2,'') <> '' THEN 
            e.dddc2 
    ELSE 
        e.dddc3 
    END AS ddd, 
    CASE 
        WHEN IFNULL(e.celular,'') <> '' THEN 
            e.celular 
        WHEN IFNULL(e.celular2,'') <> '' THEN 
            e.celular2 
    ELSE 
        e.celular3 
    END AS celular, 
    e.estado 
FROM cheques a 
   INNER JOIN clientes e 
      ON a.cpfCnpj = e.cpfCnpj 
   INNER JOIN operacao c 
     ON a.cpfCnpj = c.cpfCnpj 
        AND a.operacao = c.operacao 
  LEFT JOIN ListaNegra LN 
    ON (LN.cpfcnpj = A.cpfcnpj) 
  LEFT JOIN ListaNegraMotivo LM 
    ON (LM.codigoMotivo = LN.codigoMotivo AND LM.bloqueio_env_cobr_int = 'S') 
  INNER JOIN bdFechamento.financeiroLoteBacen flb USE INDEX( PRIMARY ) 
    ON a.cpfCnpj = flb.cpfCnpj 
WHERE  IFNULL(e.cobrancaSuspensa, 'N') = 'N' 
   AND NOT EXISTS( SELECT * 
                   FROM operacao 
                   WHERE cpfCnpj = a.cpfCnpj 
                      AND IFNULL( bloqueioJudicial, 'N' ) = 'S' ) 
   AND NOT EXISTS( SELECT * FROM clienteProcesso WHERE cpfCnpj = CONVERT( a.cpfCnpj USING LATIN1) ) 
   AND NOT EXISTS( SELECT * 
                   FROM tab_acordos 
                   WHERE cpfCnpj = a.cpfCnpj 
                      AND tip_acordo = 19) 
   AND IFNULL(e.processo,'N') = 'N' 
   AND  IFNULL( e.liminar, 'N') = 'N' 
   AND IFNULL( e.processoAdm, 'N') = 'N' 
   AND ( ( a.datMov BETWEEN ADDDATE( CURDATE(), INTERVAL -45 DAY) 
             AND ADDDATE( CURDATE(), INTERVAL -1 DAY ) 
             AND a.datPag IS NULL  
             AND NOT EXISTS( SELECT x1.num_acordo 
                             FROM tab_acordos_originais x1 
                                INNER JOIN tab_acordos x2 
                                   ON x1.num_acordo = x2.num_acordo 
                                      AND x2.cdSituacao IN (1,2) 
                             WHERE x1.cheque = a.cheque ) ) 
            OR 
         ( a.datPag IS NULL 												
              AND IFNULL(e.cobrancaInterna,'N') = 'S'  	
              AND NOT EXISTS( SELECT * FROM tab_acordos WHERE cpfCnpj = a.cpfCnpj AND cdSituacao IN (1,2) )   ) ) 
   AND c.banco IS NOT NULL 
   AND IFNULL(a.situacao,'') NOT IN ( 'BAIXADO', 'COBRANCA', 'DEVOLUÇÃO') 
   AND c.cdProduto IN ( 1,6 ) 
